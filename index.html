<!doctype html>
<html lang="ko" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>서울교통공사_외국인 관광객 기간권 일별 유출통계</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Noto+Sans+KR:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #111318;
      --ink: #e8eaed;
      --muted: #a9b0ba;
      --accent1: #7dd3fc;
      --accent2: #a78bfa;
      --accent3: #22d3ee;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --ring: 0 0 0 1px rgba(255,255,255,.1) inset;
    }
    [data-theme="light"] {
      --bg: #f8fafc;
      --panel: #ffffff;
      --ink: #0f172a;
      --muted: #64748b;
      --accent1: #2563eb;
      --accent2: #7c3aed;
      --accent3: #06b6d4;
      --shadow: 0 10px 24px rgba(2,6,23,.08);
      --ring: 0 0 0 1px rgba(2,6,23,.06) inset;
    }
    * { box-sizing: border-box }
    body {
      margin: 0; background: var(--bg); color: var(--ink);
      font-family: Inter, 'Noto Sans KR', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      line-height: 1.45;
    }
    header {
      display:flex; align-items:center; justify-content:space-between;
      padding: 28px clamp(16px, 4vw, 40px);
    }
    .brand {
      font-weight: 800; letter-spacing: -0.02em; font-size: clamp(18px, 2vw, 22px);
    }
    .toggle {
      appearance: none; border:0; border-radius: 999px; padding:10px 14px; cursor:pointer;
      color: var(--ink); background: linear-gradient(90deg,var(--accent1),var(--accent2));
      box-shadow: var(--shadow); font-weight: 700;
    }
    .wrap { padding: 0 clamp(16px, 4vw, 40px) 40px; }
    .kpis {
      display:grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap:14px; margin-bottom:18px;
    }
    .kpi {
      background: var(--panel); border-radius: 18px; padding:16px 18px; 
      box-shadow: var(--shadow); position:relative; overflow:hidden; border:0; 
    }
    .kpi::after {
      content:""; position:absolute; inset:0; background: radial-gradient(600px 120px at 100% -10%, rgba(125,211,252,.18), transparent 60%),
                                   radial-gradient(600px 120px at -10% 120%, rgba(167,139,250,.15), transparent 60%);
      pointer-events:none; mix-blend: screen;
    }
    .kpi h3 { margin:0; font-size:12px; color: var(--muted); font-weight:600 }
    .kpi p  { margin:6px 0 0; font-size: clamp(22px, 3vw, 28px); font-weight:800 }
    .grid {
      display:grid; grid-template-columns: 1.2fr 1fr; gap:16px;
    }
    @media (max-width: 1100px) { .grid { grid-template-columns: 1fr; } .kpis { grid-template-columns: repeat(2,1fr); } }
    .card {
      background: var(--panel); border-radius: 22px; padding: 18px; box-shadow: var(--shadow);
      border:0; position:relative; overflow:hidden;
    }
    .card h2 { margin: 6px 0 14px; font-size: 16px }
    .sub { color: var(--muted); font-size: 12px; margin-top:6px }
    canvas { width:100%; height: 420px; }
  </style>
</head>
<body>
  <header>
    <div class="brand">서울교통공사_외국인 관광객 기간권 일별 유출통계 [외국인 관광객 기간권 · 대시보드]</div>
    <button class="toggle" id="themeBtn">🌗 Theme</button>
  </header>

  <div class="wrap">
    <section class="kpis">
      <div class="kpi"><h3>총 유출건수</h3><p>111</p></div>
      <div class="kpi"><h3>피크 월</h3><p>2025-04 <span style="font-weight:600;color:var(--muted);">(44)</span></p></div>
      <div class="kpi"><h3>피크 일</h3><p>2025-03-17 <span style="font-weight:600;color:var(--muted);">(10)</span></p></div>
      <div class="kpi"><h3>Top 하차역</h3><p>봉은사 <span style="font-weight:600;color:var(--muted);">(27)</span></p></div>
    </section>

    <section class="grid">
      <article class="card">
        <h2>① 일자별 유출건수 · 값 오름차순 (분포/이상치 탐색)</h2>
        <canvas id="dailySorted"></canvas>
        <div class="sub">낮은 날 → 높은 날로 정렬. 분포의 꼬리와 점프 지점을 즉시 확인.</div>
      </article>
      <article class="card">
        <h2>② 월별 총 유출건수 (트렌드)</h2>
        <canvas id="monthly"></canvas>
        <div class="sub">월 합계로 계절성/증감 추세를 파악.</div>
      </article>
      <article class="card" style="grid-column: 1 / -1;">
        <h2>③ 하차역 TOP 12 (누적 유출건수)</h2>
        <canvas id="topStations"></canvas>
        <div class="sub">핫스팟 역을 식별하여 안내/캠페인/운영 배치를 최적화.</div>
      </article>
    </section>
  </div>

  <script>
    // Theme toggle
    const btn = document.getElementById('themeBtn');
    btn.addEventListener('click', () => {
      const root = document.documentElement;
      const next = root.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', next);
    });

    // Data embedded from Python
    const dailyLabels = ["2025-01-11", "2025-05-23", "2025-05-24", "2025-05-28", "2025-05-31", "2025-04-03", "2025-03-27", "2025-03-26", "2025-05-01", "2025-03-14", "2025-05-02", "2025-01-18", "2025-01-19", "2025-03-07", "2025-03-02", "2025-04-24", "2025-01-22", "2025-05-30", "2025-04-19", "2025-04-17", "2025-01-31", "2025-06-24", "2025-02-25", "2025-02-26", "2025-02-27", "2025-03-01", "2025-06-20", "2025-03-19", "2025-03-18", "2025-06-23", "2025-06-03", "2025-03-23", "2025-05-22", "2025-04-12", "2025-04-15", "2025-03-21", "2025-04-25", "2025-04-21", "2025-04-08", "2025-04-29", "2025-04-22", "2025-04-28", "2025-06-30", "2025-03-17"];
    const dailyValues = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 5, 6, 8, 8, 10];
    const monthlyLabels = ["2025-01", "2025-02", "2025-03", "2025-04", "2025-05", "2025-06"];
    const monthlyValues = [7, 6, 27, 44, 11, 16];
    const stationLabels = ["봉은사", "압구정로데오", "용산", "신논현", "영등포", "선정릉", "고속터미널", "대공원", "노량진", "문산", "역곡", "서울역"];
    const stationValues = [27, 13, 12, 10, 7, 5, 4, 4, 3, 3, 3, 3];

    function gradient(ctx, colorStops) {
      const {ctx: c, chartArea} = ctx.chart;
      if (!chartArea) return null;
      const g = c.createLinearGradient(chartArea.left, chartArea.bottom, chartArea.right, chartArea.top);
      colorStops.forEach(([pos, col]) => g.addColorStop(pos, col));
      return g;
    }

    const common = {
      responsive: true,
      animation: { duration: 900, easing: 'easeOutQuart' },
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: 'rgba(0,0,0,.8)',
          padding: 10,
          titleFont: { weight: '700' },
          callbacks: { label: (ctx) => ' ' + (ctx.dataset.label||'값') + ': ' + (ctx.parsed.y ?? ctx.parsed.x).toLocaleString('ko-KR') }
        }
      },
      scales: {
        y: { beginAtZero: true, grid: { color: 'rgba(148,163,184,.15)' } },
        x: { grid: { display:false } }
      }
    };

    // 1) Daily sorted bar
    new Chart(document.getElementById('dailySorted'), {
      type: 'bar',
      data: {
        labels: dailyLabels,
        datasets: [{ 
          label: '유출건수',
          data: dailyValues,
          borderRadius: 8,
          backgroundColor: (ctx) => gradient(ctx, [[0,'rgba(37,99,235,.85)'], [.5,'rgba(124,58,237,.80)'], [1,'rgba(6,182,212,.85)']]),
          hoverBackgroundColor: (ctx) => gradient(ctx, [[0,'rgba(37,99,235,1)'], [.5,'rgba(124,58,237,1)'], [1,'rgba(6,182,212,1)']])
        }]
      },
      options: Object.assign({}, common, {
        plugins: {
          legend: { display:false },
          title: { display: true, text: '낮은 날 → 높은 날' }
        },
        scales: {
          y: Object.assign({}, common.scales.y),
          x: Object.assign({}, common.scales.x, { ticks: { autoSkip: true, maxTicksLimit: 24 } })
        }
      })
    });

    // 2) Monthly totals (line+area for trend impact)
    new Chart(document.getElementById('monthly'), {
      type: 'line',
      data: {
        labels: monthlyLabels,
        datasets: [{ 
          label: '월별 합계',
          data: monthlyValues,
          fill: true,
          tension: .35,
          borderWidth: 3,
          pointRadius: 4,
          pointHoverRadius: 6,
          borderColor: 'rgba(124,58,237,1)',
          backgroundColor: (ctx) => gradient(ctx, [[0,'rgba(124,58,237,.25)'], [1,'rgba(34,211,238,.10)']])
        }]
      },
      options: Object.assign({}, common, {
        plugins: { legend: { display:false } },
      })
    });

    // 3) Top stations (horizontal bars)
    new Chart(document.getElementById('topStations'), {
      type: 'bar',
      data: {
        labels: stationLabels,
        datasets: [{ 
          label: '유출건수',
          data: stationValues,
          borderRadius: 10,
          backgroundColor: (ctx) => gradient(ctx, [[0,'rgba(34,197,94,.85)'], [1,'rgba(6,182,212,.85)']])
        }]
      },
      options: Object.assign({}, common, {
        indexAxis: 'y',
        scales: {
          x: Object.assign({}, common.scales.y),
          y: Object.assign({}, common.scales.x)
        }
      })
    });
  </script>
</body>
</html>
